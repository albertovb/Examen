YUI.add("mes-presentation-mode",function(c){var g=c.Lang;var a=c.config.win;var i=c.config.doc.documentElement;var f=new c.Template(c.Handlebars);var b=i.clientWidth;var e=i.clientHeight;var h=200;var k="<div class='node' id='index-{{index}}'>";k+="<div  class='mes-centered'>";k+="<div class='content' data-href='{{href}}' data-title='{{title}}' data-referencedContentId='{{referencedContentId}}'></div></div></div>";var d="<li id='list-{{index}}'><a data-index={{index}} title='{{title}}' href='#'>{{title}}</a></li>";var j=c.Component.create({ATTRS:{portletId:{validator:g.isString},portletType:{validator:g.isString},noAssetsMsg:{validator:g.isString}},NAME:"presentationMode",prototype:{initializer:function(){var l=this;l.parentNode=c.one("#"+l.get("portletId"));l.currentIndex=1;l.history=new c.HistoryHash();l._showFromURI();l.parentNodeHandle=l.parentNode.on("mouseenter",l._showButton,l)},bindUI:function(){var l=this;var m=[];l._eventHandles=m},_detachEvents:function(){var l=this;if(l.gesturemovestartHandle){l.gesturemovestartHandle.detach()}if(l.gesturemoveendHandle){l.gesturemoveendHandle.detach()}l.keydownHandle.detach();l.resizeHandle.detach();l.buttonPreviousHandle.detach();l.buttonNextHandle.detach();l.menuClickHandle.detach();l.closeBtnHandle.detach()},destructor:function(){var l=this;l._detachEvents();l.historyChangeHandle.detach()},_showFromURI:function(){var l=this;var m=location.hash;l.fromURI=false;m=m.replace(/^#/,"")},show:function(p){if(p){p.preventDefault()}var l=this;l.currentScrollTop=c.one("html").getDOM().scrollTop;b=i.clientWidth;e=i.clientHeight;l.fromDOM=false;l._createNode();l.presentationButton=c.one("#"+l.get("portletId")+" .mes-presentation-iniciar");if(l.get("portletType")=="portlet-asset-publisher-full-content"){l.fromDOM=true;if(!l._createIndexFromDOM()){return}}else{if(!l._createIndex()){return}}l.maxItems=l.touch.all(".node").size();l._loadEntries(l.currentIndex);l._attachEvents();l.presentationNode.setStyle("display","inline");l.presentationNode.setStyle("width","100%");l.presentationNode.setStyle("height","100%");l._toogleMenu();var o="<div class='alert alert-success' style='padding:2px;'><i class='icon icon-arrow-up'></i> "+Liferay.Language.get("mes-presentation-mode-show-hide")+"</div>";var n=new c.Overlay({headerContent:o,bodyContent:"",zIndex:2});var m=c.WidgetPositionAlign;n.render("#presentation-"+l.get("portletId"));n.set("align",{node:c.one("#menu-presentacion-"+l.get("portletId")),points:[m.TL,m.BL]});window.setTimeout(function(){l.presentationNode.one(".info-esc").setStyle("display","none");n.hide()},3000);l.history.addValue("mes_modo_presentacion",l.get("portletId"))},_closePresentation:function(){var l=this;l.presentationNode.setStyle("display","none");c.one("html").getDOM().scrollTop=l.currentScrollTop;l._detachEvents();if(l.fromDOM){l.touch.all(".node .content").each(function(q,o){if(q.getAttribute("data-loaded")){var m=q.one(".mes-content");var p=l.parentNode.one("#"+q.getAttribute("data-referencedContentId"));m.all("a").each(function(s,r){s.setAttribute("target",s.getAttribute("data-target"))});var n=c.Node.create("<div class='mes-swap'></div>");p.append(n);n.swap(m)}q.removeAttribute("data-loaded")})}},_handleClose:function(){var m=location.hash;m=m.replace(/^#/,"");var l=this;l._closePresentation()},_attachEvents:function(){var l=this;l.buttonPrevious=l.presentationNode.one(".buttonPrevious");l.buttonPreviousHandle=l.buttonPrevious.on("click",function(m){l.navigate(m,"previous")});l.buttonNextHandle=l.presentationNode.one(".buttonNext").on("click",function(m){l.navigate(m,"next")});l.keydownHandle=c.getDoc().on("keydown",function(m){if(m.isKey("ESC")){l._handleClose()}else{if(m.charCode==39){l.navigate(m,"next")}else{if(m.charCode==37){l.navigate(m,"previous")}}}});if(l.maxItems>1){l.presentationNode.one(".buttonsHolderNormal").setStyle("display","inline");l.gesturemovestartHandle=l.touch.on("gesturemovestart",function(n){l.touch.setData("swipeStart",n.pageX);var m=l.touch.one("#index-"+l.currentIndex).addClass("noselect")});l.gesturemoveendHandle=l.touch.on("gesturemoveend",function(p){l.touch.one("#index-"+l.currentIndex).removeClass("noselect");var q=l.touch.getData("swipeStart"),n=p.pageX,o=(q-n)>h;o=true;if(n>q){o=false}var m=Math.abs(q-n);if(m>h){if(o){l.navigate(p,"next")}else{l.navigate(p,"previous")}}})}l.resizeHandle=c.on("windowresize",function(){b=i.clientWidth;e=i.clientHeight;l.touch.all(".node").each(function(o,m){o.setStyle("width",b+"px");o.setStyle("height",e+"px");o.one(".content").setStyle("width",(b-100)+"px");var n=m+1;if(l.currentIndex!=n){o.setStyle("left","-"+b+"px")}})});l.historyChangeHandle=c.on("history:change",function(m){if(m.src===c.HistoryHash.SRC_HASH){l._manageHistory(m)}});l.menuClickHandle=l.menuBtn.on("click",l._toogleMenu,l);l.closeBtnHandle=l.closeBtn.on("click",l._handleClose,l)},_showButton:function(m){var l=this;c.all(".mes-presentation-iniciar").setStyle("display","none");l.parentNode.one(".mes-presentation-iniciar").setStyle("display","inline")},_manageHistory:function(m){var l=this;if(m.changed.mes_modo_presentacion){if(m.changed.mes_modo_presentacion.newVal==l.get("portletId")){l.show()}}else{l._closePresentation()}},renderUI:function(m){var l=this;l.show()},_createIndexFromDOM:function(){var l=this;if(l.indiceCreado){l.touch.one("#index-"+l.currentIndex).setStyle("left","0");return true}l.indiceCreado=true;var m=l.parentNode.all(".mes-full-content");m.each(function(p,n){title=p.getAttribute("data-title");var o=c.Node.create(f.render(k,{href:"",title:title,index:n+1,referencedContentId:p.get("id")}));l.touch.append(o);var q=c.Node.create(f.render(d,{title:title,index:n+1}));l.menuList.append(q);q.one("a").on("click",l._gotoItem,l);if(n>0){o.setStyle("left","-"+b+"px")}else{q.addClass("mes-presentation-selected")}});return(m.size()>0)},_createIndex:function(){var l=this;var q=true;if(l.indiceCreado){l.touch.one("#index-"+l.currentIndex).setStyle("left","0");return true}var l=this;var m;if((l.get("portletType")=="mes-visor-carpeta-contenidos")||(l.get("portletType")=="mes-visor-carpeta-documentos")){m=l.parentNode.all("li.article a")}else{if(l.get("portletType")=="portlet-asset-publisher-abstracts"){m=l.parentNode.all(".journal-content-title a")}else{if(l.get("portletType")=="portlet-asset-publisher-table"){m=l.parentNode.all("td a.mes-content")}else{if(l.get("portletType")=="portlet-asset-publisher-title-list"){m=l.parentNode.all(".portlet-journal-title-list a.mes-content")}else{if(l.get("portletType")=="portlet-asset-publisher-modo-libro"){m=l.parentNode.all(".portlet-journal-title-list a.mes-content")}else{if(l.get("portletType")=="portlet-asset-publisher-modo-panel"){m=l.parentNode.all(".journal-content-title a")}else{q=false}}}}}}var o=0;var n="";var p="";if(q&&(m.size()==0)){q=false}if(q){m.each(function(v,s){var r;r=v.getAttribute("href");if((r!="#")&&(r!="")&&!(r.lastIndexOf("javascript:",0)===0)){if(l.get("portletType")=="portlet-asset-publisher-modo-libro"){var y=r.indexOf("_assetId");if(y>0){var x=r.substring(y);var u=l.get("portletId");u=u.substring(7,u.length-1);var r=location.pathname+"?p_p_id="+u+"&p_p_action=0&p_p_state=exclusive";r+="&p_p_mode=view&_"+u+"_struts_action=%2Ftagged_content%2Fview_content&_"+u;r+=x}}else{if(r.indexOf("p_p_state=pop_up")>=0){r=r.replace("p_p_state=pop_up","p_p_state=exclusive")}else{if(r.indexOf("p_p_state=maximized")>=0){r=r.replace("p_p_state=maximized","p_p_state=exclusive")}else{if(r.indexOf("p_p_state=normal")>=0){r=r.replace("p_p_state=normal","p_p_state=exclusive")}else{if(r.indexOf("/maximized")>=0){r=r.replace("/maximized","/exclusive")}}}}}o++;p=l._getTitle(v);var t=c.Node.create(f.render(k,{href:r,title:p,index:o,referencedContentId:""}));l.touch.append(t);var w=c.Node.create(f.render(d,{title:p,index:o}));l.menuList.append(w);w.one("a").on("click",l._gotoItem,l);if(o>1){t.setStyle("left","-"+b+"px")}else{w.addClass("mes-presentation-selected")}}});l.indiceCreado=true}else{alert(l.get("noAssetsMsg"));l.presentationButton.setStyle("display","none")}return q},_getTitle:function(m){var l=this;var n=m.clone();if(l.get("portletType")=="portlet-asset-publisher-abstracts"){if(n.one("img")){n.one("img").remove()}}return n.getHTML()},_gotoItem:function(n){var l=this;var m=c.one(n.target);l.navigate(n,"goto",m.getAttribute("data-index"))},_activateCurrentItem:function(m){var l=this;l.menuList.all("li").removeClass("mes-presentation-selected");m.addClass("mes-presentation-selected")},_createNode:function(){var l=this;if(!l.presentationNode){var m="<div id='presentation-"+l.get("portletId")+"' class='mes-presentation maximized' style='display:none; width:0; height:0'>";m+="<div class='info-esc alert alert-info'>"+Liferay.Language.get("mes-presentation-mode-pulse-esc")+"</div>";m+="<button class='close' type='button'>&times;</button>";m+="<a title='"+Liferay.Language.get("view-topics")+"' id='menu-presentacion-"+l.get("portletId")+"' class='mes-presentation-menu-btn mes-menu-closed btn' style='position:absolute; z-index:2'><i class='icon icon-reorder'> </i></a>";m+="<div class='menu-presentacion-content' id='menu-presentacion-content-"+l.get("portletId")+"'>";m+="<ul class='mes-presentation-menu'></ul>";m+="</div>";m+="<div class='mes-presentation-title' id='title-"+l.get("portletId")+"'></div>";m+="<div class='buttonsHolderNormal' style='display:none'>";m+="<button class='buttonPrevious btn btn-small'><i class='icon-arrow-left'></i></button>";m+="<button class='buttonNext btn btn-small'><i class='icon-arrow-right'></i></button>";m+="</div><div class='targetNode'></div></div>";l.presentationNode=c.Node.create(m);l.title=l.presentationNode.one("#title-"+l.get("portletId"));l.menuBtn=l.presentationNode.one("#menu-presentacion-"+l.get("portletId"));l.menuContent=l.presentationNode.one("#menu-presentacion-content-"+l.get("portletId"));l.menuList=l.presentationNode.one("#menu-presentacion-content-"+l.get("portletId")+" ul");l.closeBtn=l.presentationNode.one("button.close");c.one("body").append(l.presentationNode);l.touch=l.presentationNode.one(".targetNode")}},_toogleMenu:function(m){var l=this;if(m){m.preventDefault()}if(l.menuBtn.hasClass("mes-menu-closed")){l.buttonPrevious.setStyle("left","300px");l.menuContent.setStyle("display","inline");l.touch.one("#index-"+l.currentIndex).setStyle("left","0");var n=new c.Anim({node:l.touch.one("#index-"+l.currentIndex),duration:0.5,easing:c.Easing.easeBoth});n.set("to",{xy:[300,0]});n.run()}else{l.menuContent.setStyle("display","none");l.buttonPrevious.setStyle("left","0");var n=new c.Anim({node:l.touch.one("#index-"+l.currentIndex),duration:0.5,easing:c.Easing.easeBoth});n.set("to",{xy:[0,0]});n.run()}l.menuBtn.toggleClass("mes-menu-closed")},navigate:function(n,s,t){var u=this;var t=t||null;n.preventDefault();var l=u.currentIndex;if(s=="goto"){if(t<u.currentIndex){s="previous";u.currentIndex=t}else{if(t>u.currentIndex){s="next";u.currentIndex=t}else{return}}}else{if(s=="previous"){if(u.currentIndex>1){u.currentIndex--}else{u.currentIndex=u.maxItems}}else{if(u.currentIndex<u.maxItems){u.currentIndex++}else{u.currentIndex=1}}}u.presentationNode.one(".buttonPrevious").setAttribute("disabled",true);u.presentationNode.one(".buttonNext").setAttribute("disabled",true);var m;var v=u.touch.one("#index-"+l);var p=u.touch.one("#index-"+u.currentIndex);var q=u.menuList.one("#list-"+u.currentIndex);u._activateCurrentItem(q);var o,r;if(s=="previous"){v.setStyle("left","0");v.setStyle("top","0");p.setStyle("left","-"+b+"px");p.setStyle("top","0");o=new c.Anim({node:v,duration:0.5,easing:c.Easing.easeBoth});o.set("to",{xy:[b,0]});o.run();r=new c.Anim({node:p,duration:0.5,easing:c.Easing.easeBoth});if(u.menuBtn.hasClass("mes-menu-closed")){r.set("to",{xy:[0,0]})}else{r.set("to",{xy:[300,0]})}r.run();r.on("end",function(){p.setStyle("top","0")})}else{v.setStyle("left","0");v.setStyle("top","0");p.setStyle("left",b+"px");p.setStyle("top","0");o=new c.Anim({node:v,duration:0.5,easing:c.Easing.easeBoth});o.set("to",{xy:[-b,0]});o.run();r=new c.Anim({node:p,duration:0.5,easing:c.Easing.easeBoth});if(u.menuBtn.hasClass("mes-menu-closed")){r.set("to",{xy:[0,0]})}else{r.set("to",{xy:[300,0]})}r.run();r.on("end",function(){p.setStyle("top","0")})}u._loadEntries(u.currentIndex);u.presentationNode.one(".buttonPrevious").removeAttribute("disabled");u.presentationNode.one(".buttonNext").removeAttribute("disabled")},_loadEntries:function(m){window.scrollTo(0,0);var l=this;l._loadEntry(l.currentIndex);var p=l.touch.one("#index-"+m).one(".content");l.title.setHTML(p.getAttribute("data-title"));var o=l.currentIndex-1;l._loadEntry(o);var n=l.currentIndex+1;l._loadEntry(n)},_loadEntry:function(r){var v=this;if(r<=0){r=v.maxItems}if(r>v.maxItems){r=1}var n=v.touch.one("#index-"+r);n.one(".mes-centered").setStyle("width",b+"px");var s=n.one(".content");if(s.getAttribute("data-loaded")){return}else{var u=s.getAttribute("data-title");s.setAttribute("data-loaded","1");s.setStyle("width",(b-100)+"px");if(v.fromDOM){var t=v.parentNode.one("#"+s.getAttribute("data-referencedContentId")+" .mes-content");var p=c.Node.create("<div class='mes-swap'></div>");s.append(p);t.all("img.mac-lazy-load").each(function(x,y){if(x.get("src")==""){x.set("src",x.getAttribute("data-lazy-src"))}});p.swap(t)}else{var w=s.getAttribute("data-href");var o=true;if(((w.indexOf("http://")==0)||(w.indexOf("https://")==0))&&((w.indexOf(themeDisplay.getURLHome())!=0))){var q="<div class='mes-modal-info portlet-msg-info' style='position:relative; padding-right:0;'>";q+="<div>"+Liferay.Language.get("mes-presentation-mode-iframe");q+=" <a target='_blank' href='"+w+"'>"+w+"</a>";q+="</div>";q+="<button class='close' style='border:none; padding:0; position:absolute; right:0; background-color:transparent; opacity:.7' type='button'>&times;</button>";q+="</div>";var m=c.config.doc.documentElement.clientHeight-120;q+="<iframe class='mes-iframe-modal' src='"+w+"' width='98%' height='"+m+"px' frameborder='0' marginheight='0' marginwidth='0'></iframe>";o=false;s.setContent(q);s.setStyle("overflow","hidden");c.on("windowresize",function(){var x=c.config.doc.documentElement.clientHeight-120;c.all(".mes-iframe-modal").setAttribute("height",x+"px")});o=false}else{if((w.indexOf("/c/document_library/get_file")==0)||(w.indexOf(themeDisplay.getURLHome()+"/c/document_library/get_file")==0)){if((w.indexOf(".png",w.length-".png".length)!==-1)||(w.indexOf(".gif",w.length-".gif".length)!==-1)||(w.indexOf(".jpeg",w.length-".jpeg".length)!==-1)||(w.indexOf(".jpg",w.length-".jpg".length)!==-1)){s.setContent("<img class='mes-presentation-mode' src='"+w+"'>");o=false}else{if((w.indexOf(".pdf",w.length-".pdf".length)!==-1)){var m=c.config.doc.documentElement.clientHeight-120;w="/html/js/pdf.js/web/viewer.html?file="+encodeURIComponent(w);var q="<div class='mes-modal-info portlet-msg-info' style='position:relative; padding-right:0;'>";q+="<div>";q+="<a target='_blank' href='"+w+"'>"+Liferay.Language.get("mes-presentation-mode-ventana-nueva")+"</a>";q+="</div>";q+="<button class='close' style='border:none; padding:0; position:absolute; right:0; background-color:transparent; opacity:.7' type='button'>&times;</button>";q+="</div>";q+="<iframe class='pdf-modal-wrapper' frameborder=0; width=100%; height="+m+"px; src='"+w+"'></iframe>";s.setContent(q);s.setStyle("overflow","hidden");c.on("windowresize",function(){var x=c.config.doc.documentElement.clientHeight-120;c.all(".pdf-modal-wrapper").setAttribute("height",x+"px")});o=false}else{var q="<div class='mes-modal-info portlet-msg-info' style='position:relative; padding-right:0;'>";q+="<div>";q+="<a target='_blank' href='"+w+"'>"+Liferay.Language.get("download")+" "+w+"</a>";q+="</div>";q+="</div>";s.setContent(q);o=false}}}}if(o){var l="	<div style='height:20px; width:100%;'>";l+="		<div class='portlet-msg-info'>";l+="			<img style='vertical-align:middle;' src='"+themeDisplay.getPathThemeImages()+"/progress_bar/loading_animation.gif'>";l+="			<span style='margin-left:10px; font-weight:bold; font-size:1.3em;'>"+Liferay.Language.get("mes-presentation-mode-loading")+"</span>";l+="		</div>";l+="	</div>";s.setContent(l);c.io.request(w,{cache:true,after:{failure:function(x){s.setContent("<a target='_blank' href='"+w+"'>"+w+"</a>")},success:function(){var x=this.get("responseData");s.plug(c.Plugin.ParseContent);s.setContent(x);s.all("a").each(function(z,y){if((z.get("href").indexOf("javascript")!=0)&&(z.getAttribute("target")!="_blank")){z.setAttribute("data-target",z.getAttribute("target"));z.setAttribute("target","_blank")}});s.all(".mes-hide-pop-up").setStyle("display","none");s.all("img.mac-lazy-load").each(function(y,z){if(y.get("src")==""){y.set("src",y.getAttribute("data-lazy-src"))}})}}})}}c.all(".mes-modal-info button").on("click",function(){c.all(".mes-modal-info").setStyle("display","none")})}},}});c.MesPresentationMode=j},"",{requires:["history","template-base","overlay","handlebars","node-base","node-event-delegate","transition","event-move","anim","event-key","node-event-delegate","aui-node","node","aui-base","aui-io-request","aui-parse-content","history","event-resize","aui-event-base","aui-toggler"]});var mesModalContent;var mesModalContentShowed=false;var mesModalContentWidth;var mesModalContentHeight;var mesModalTarget;var mesModalTitle;var mesModalLoading;var autoload=false;YUI().use("node","overlay","panel","aui-modal","aui-io-request","aui-parse-content","event-key","history","overlay","node-base","event-key","aui-node","aui-base","aui-event-base","cookie",function(a){a.on("domready",function(){var c;if(!a.one("#mes-modal-content")){historyModalContent=new a.HistoryHash();var b="<div id='mes-modal-content' class='mes-presentation maximized'>";b+="<button class='close' type='button'>&times;</button>";b+="<div class='targetNode'></div>";b+="</div>";mesModalContent=a.Node.create(b);a.one("body").append(mesModalContent);mesModalTarget=mesModalContent.one(".targetNode");mesModalTitle=mesModalContent.one(".title");closeBtn=mesModalContent.one("button.close");closeBtn.on("click",function(){j()});a.getDoc().on("keydown",function(k){if(k.isKey("ESC")){j()}});b="	<div id='mes-modal-content-loading' style='display:none;'>";b+="		<div style='text-align:center'>";b+="			<span class='label label-warning'>"+Liferay.Language.get("mes-presentation-mode-loading")+"</span>";b+="		</div>";b+="	</div>";mesModalLoading=a.Node.create(b);a.one("body").append(mesModalLoading)}a.on("windowresize",h);function h(){var k=a.config.doc.documentElement.clientWidth;var m=26;var l=50;if(!autoload){if((k>=350)&&(k<974)){m=14;l=30}else{if(k<350){m=8;l=10}}}else{m=151;l=300;if((k>=350)&&(k<974)){m=76;l=150}else{if(k<350){m=31;l=60}}}mesModalContentWidth=a.config.doc.documentElement.clientWidth-l;mesModalContentHeight=a.config.doc.documentElement.clientHeight-l;if(mesModalContentShowed){mesModalContent.setStyle("width",mesModalContentWidth+"px");mesModalContent.setStyle("height",mesModalContentHeight+"px")}mesModalContent.setStyle("margin",m+"px")}var i=".container-assets-modo-panel.mes-asset-pantalla-completa .mes-modo-panel-container, ";i+=".container-assets-abstracts.mes-asset-pantalla-completa .journal-content-title, ";i+=".container-assets-abstracts.mes-asset-pantalla-completa .portlet-journal-more, ";i+=".container-assets-table.mes-asset-pantalla-completa td a.mes-content, ";i+=".container-assets-title-list.mes-asset-pantalla-completa li a.mes-content, ";i+=".container-assets-modo-libro.mes-asset-pantalla-completa li a.mes-content";var f=a.all(i);f.on("click",e);function e(l){var k=a.one(l.currentTarget);g(k,l,false)}function j(){mesModalContentShowed=false;mesModalContent.removeClass("mes-asset-mostrar-alerta");mesModalContent.setStyle("width","0");mesModalContent.setStyle("height","0");var k=a.one("#mes-mask");if(k&&autoload){k.toggleClass("show").toggleClass("hide")}if(c){mesModalTarget.setContent("");c=null}}function d(){var l="showAlertMsg"+location.pathname;if(a.Cookie.exists(l)){return}var n=".mes-asset-mostrar-alerta.mes-asset-mostrar-todos-alerta, ";n+=".mes-asset-mostrar-alerta.container-assets-full-content .mes-full-content, ";n+=".mes-asset-mostrar-alerta.container-assets-modo-panel .mes-modo-panel-container, ";n+=".mes-asset-mostrar-alerta.container-assets-abstracts .journal-content-title, ";n+=".mes-asset-mostrar-alerta.container-assets-abstracts .portlet-journal-more, ";n+=".mes-asset-mostrar-alerta.container-assets-table td a.mes-content, ";n+=".mes-asset-mostrar-alerta.container-assets-title-list li a.mes-content, ";n+=".mes-asset-mostrar-alerta.container-assets-modo-libro li a.mes-content";var m=a.one(n);var k=false;if(m){if(m.hasClass("mes-full-content")||m.hasClass("mes-asset-mostrar-todos-alerta")){k=true;c=m}g(m,null,k);a.Cookie.set(l,"1")}}function g(m,k,l){var u="";autoload=true;if(k){autoload=false}if(!l){if(m.hasClass("mes-modo-panel-container")){if(k){var t=k.target;while(t&&(!t.hasClass("mes-modo-panel-container"))){if(t.hasClass("mes-panel-actions")){return}t=t.ancestor()}}u=m.getAttribute("data-href")}else{if(m.ancestor().hasClass("portlet-journal-abstract")){u=m.one("a").get("href")}else{if(m.hasClass("mes-content")){u=m.get("href");m=m.ancestor();while(m&&(!m.hasClass("mes-asset-pantalla-completa"))){m=m.ancestor()}if((m)&&(m.hasClass("container-assets-modo-libro"))){var s=m;while(s&&(!s.hasClass("portlet-boundary"))){s=s.ancestor()}if(s){var o=u.indexOf("_assetId");if(o>0){var w=u.substring(o);var r=s.get("id");r=r.substring(7,r.length-1);u=location.pathname+"?p_p_id="+r+"&p_p_action=0&p_p_state=exclusive";u+="&p_p_mode=view&_"+r+"_struts_action=%2Ftagged_content%2Fview_content&_"+r;u+=w}}}}}}if(u==""){return}}if(k){k.preventDefault();k.stopPropagation();historyModalContent.addValue("mes_modal_content","p_p_id")}mesModalContentShowed=true;if(autoload){var v=a.one("#mes-mask");if(!v){v=a.Node.create('<div id="mes-mask" class="mes-mask hide" style="position: fixed; width: 100%; height: 100%; top: 0px; left: 0px; display: none; z-index: 1;" hidden="true"></div>');a.one("body").append(v)}v.toggleClass("hide").toggleClass("show");mesModalContent.addClass("mes-asset-mostrar-alerta")}else{mesModalContent.removeClass("mes-asset-mostrar-alerta")}h();mesModalLoading.setStyle("display","inline");var p=true;var q="";if(u.indexOf("p_p_state=pop_up")>=0){u=u.replace("p_p_state=pop_up","p_p_state=exclusive")}else{if(u.indexOf("p_p_state=maximized")>=0){u=u.replace("p_p_state=maximized","p_p_state=exclusive")}else{if(u.indexOf("p_p_state=normal")>=0){u=u.replace("p_p_state=normal","p_p_state=exclusive")}else{if(u.indexOf("/maximized")>=0){u=u.replace("/maximized","/exclusive")}}}}mesModalTarget.setStyle("overflow","auto");if(l){p=false}else{if(((u.indexOf("http://")==0)||(u.indexOf("https://")==0))&&((u.indexOf(themeDisplay.getURLHome())!=0))){q+="<div class='mes-modal-info portlet-msg-info' style='position:relative; padding-right:0;'>";q+="<div>"+Liferay.Language.get("mes-presentation-mode-iframe");q+=" <a target='_blank' href='"+u+"'>"+u+"</a>";q+="</div>";q+="<button class='close' type='button'>&times;</button>";q+="</div>";var n=a.config.doc.documentElement.clientHeight-120;q+="<iframe class='mes-iframe-modal' src='"+u+"' width='98%' height='"+n+"px' frameborder='0' marginheight='0' marginwidth='0'></iframe>";p=false;mesModalTarget.setStyle("overflow","hidden");a.on("windowresize",function(){var x=a.config.doc.documentElement.clientHeight-120;a.all(".mes-iframe-modal").setAttribute("height",x+"px")})}else{if((u.indexOf("/c/document_library/get_file")==0)||(u.indexOf(themeDisplay.getURLHome()+"/c/document_library/get_file")==0)){if((u.indexOf(".png",u.length-".png".length)!==-1)||(u.indexOf(".gif",u.length-".gif".length)!==-1)||(u.indexOf(".jpeg",u.length-".jpeg".length)!==-1)||(u.indexOf(".jpg",u.length-".jpg".length)!==-1)){q+="<img class='mes-presentation-mode' src='"+u+"'>";p=false}else{if((u.indexOf(".pdf",u.length-".pdf".length)!==-1)){var n=a.config.doc.documentElement.clientHeight-120;q+="<div class='mes-modal-info portlet-msg-info' style='position:relative; padding-right:0;'>";q+="<div>";q+="<a target='_blank' href='"+u+"'>"+Liferay.Language.get("mes-presentation-mode-ventana-nueva")+"</a>";q+="</div>";q+="<button class='close' type='button'>&times;</button>";q+="</div>";u="/html/js/pdf.js/web/viewer.html?file="+encodeURIComponent(u);q+="<iframe class='pdf-modal-wrapper' frameborder=0; width=100%; height="+n+"px; src='"+u+"'></iframe>";p=false;mesModalTarget.setStyle("overflow","hidden");a.on("windowresize",function(){var x=a.config.doc.documentElement.clientHeight-120;a.all(".pdf-modal-wrapper").setAttribute("height",x+"px")})}else{q+="<div class='mes-modal-info portlet-msg-info' style='position:relative; padding-right:0;'>";q+="<div>";q+="<a target='_blank' href='"+u+"'>"+Liferay.Language.get("download")+" "+u+"</a>";q+="</div>";q+="</div>";p=false}}}}}if(p){a.io.request(u,{cache:true,on:{start:function(){},end:function(){window.setTimeout(function(){mesModalLoading.setStyle("display","none")},500)}},after:{failure:function(x){mesModalContent.setStyle("width",mesModalContentWidth+"px");mesModalContent.setStyle("height",mesModalContentHeight+"px");mesModalTarget.setContent("<a target='_blank' href='"+u+"'>"+u+"</a>")},success:function(){var x=this.get("responseData");mesModalContent.setStyle("width",mesModalContentWidth+"px");mesModalContent.setStyle("height",mesModalContentHeight+"px");mesModalTarget.plug(a.Plugin.ParseContent);mesModalTarget.setContent(x);if(!autoload){mesModalTarget.all("a").each(function(z,y){if((z.get("href").indexOf("javascript")!=0)&&(z.getAttribute("target")!="_blank")){z.setAttribute("data-target",z.getAttribute("target"));z.setAttribute("target","_blank")}})}mesModalTarget.all(".mes-hide-pop-up").setStyle("display","none");mesModalTarget.all("img.mac-lazy-load").each(function(y,z){if(y.get("src")==""){y.set("src",y.getAttribute("data-lazy-src"))}})}}})}else{mesModalContent.setStyle("width",mesModalContentWidth+"px");mesModalContent.setStyle("height",mesModalContentHeight+"px");if(l){mesModalTarget.setContent(m.getHTML())}else{mesModalTarget.setContent(q)}if(!autoload){mesModalTarget.all("a").each(function(y,x){if((y.get("href").indexOf("javascript")!=0)&&(y.getAttribute("target")!="_blank")){y.setAttribute("data-target",y.getAttribute("target"));y.setAttribute("target","_blank")}})}mesModalTarget.all(".mes-hide-pop-up").setStyle("display","none");mesModalTarget.all("img.mac-lazy-load").each(function(x,y){if(x.get("src")==""){x.set("src",x.getAttribute("data-lazy-src"))}});a.all(".mes-modal-info button").on("click",function(){a.all(".mes-modal-info").setStyle("display","none")});window.setTimeout(function(){mesModalLoading.setStyle("display","none")},500)}}d()})});